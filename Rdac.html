
<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>RDAC QR Scanner</title>
Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
Â  <script src="https://unpkg.com/html5-qrcode"></script>
Â  <style>
Â  Â  * {
Â  Â  Â  box-sizing: border-box;
Â  Â  }

Â  Â  body {
Â  Â  Â  margin: 0;
Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  padding: 0;
Â  Â  Â  background: #f0f0f0;
Â  Â  }

Â  Â  #qrcode-container {
Â  Â  Â  position: fixed;
Â  Â  Â  top: 0;
Â  Â  Â  left: 0;
Â  Â  Â  width: 100%;
Â  Â  Â  height: 50vh;
Â  Â  Â  display: none;
Â  Â  Â  background: white;
Â  Â  Â  z-index: 1000;
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: center;
Â  Â  Â  border-bottom: 2px solid #ccc;
Â  Â  }

Â  Â  #qrcode {
Â  Â  Â  display: inline-block;
Â  Â  }

Â  Â  #rdac-input {
Â  Â  Â  width: 100%;
Â  Â  Â  font-size: 1.5rem;
Â  Â  Â  padding: 12px;
Â  Â  Â  margin-top: 52vh;
Â  Â  }

Â  Â  .button-container {
Â  Â  Â  position: fixed;
Â  Â  Â  bottom: 0;
Â  Â  Â  left: 0;
Â  Â  Â  width: 100%;
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  background: #fff;
Â  Â  Â  border-top: 1px solid #ccc;
Â  Â  Â  z-index: 1000;
Â  Â  }

Â  Â  .large-button {
Â  Â  Â  flex: 1;
Â  Â  Â  padding: 30px 0;
Â  Â  Â  font-size: 1.3rem;
Â  Â  Â  background-color: #007bff;
Â  Â  Â  color: white;
Â  Â  Â  border: none;
Â  Â  Â  touch-action: manipulation;
Â  Â  }

Â  Â  .large-button:first-child {
Â  Â  Â  border-right: 1px solid #ccc;
Â  Â  }

Â  Â  /* Scanner UI */
Â  Â  #scanner {
Â  Â  Â  display: none;
Â  Â  Â  width: 100%;
Â  Â  Â  max-width: 400px;
Â  Â  Â  margin: 10px auto;
Â  Â  Â  z-index: 999;
Â  Â  }

Â  Â  #scan-btn {
Â  Â  Â  width: 100%;
Â  Â  Â  font-size: 1.2rem;
Â  Â  Â  padding: 15px;
Â  Â  Â  background-color: #28a745;
Â  Â  Â  color: white;
Â  Â  Â  border: none;
Â  Â  }
Â  </style>
</head>
<body>

Â  <!-- QR Code Display Section -->
Â  <div id="qrcode-container">
Â  Â  <div id="qrcode"></div>
Â  </div>

Â  <!-- Scan Button -->
Â  <button id="scan-btn">ðŸ“· Scan Barcode</button>

Â  <!-- Scanner Video Stream -->
Â  <div id="scanner"></div>

Â  <!-- RDAC Input -->
Â  <input id="rdac-input" type="text" placeholder="Scan RDAC barcode..." autocomplete="off" />

Â  <!-- Button Section -->
Â  <div class="button-container">
Â  Â  <button id="left-btn" class="large-button">Left</button>
Â  Â  <button id="right-btn" class="large-button">Right</button>
Â  </div>

Â  <script>
Â  Â  let rdacCode = '';
Â  Â  let leftHeld = false;
Â  Â  let rightHeld = false;
Â  Â  let scannerStarted = false;

Â  Â  const rdacInput = document.getElementById('rdac-input');
Â  Â  const qrcodeContainer = document.getElementById('qrcode-container');
Â  Â  const qrcodeDiv = document.getElementById('qrcode');
Â  Â  const scanBtn = document.getElementById('scan-btn');
Â  Â  const scannerDiv = document.getElementById('scanner');

Â  Â  let qr;

Â  Â  // Handle input from scanner or manual entry
Â  Â  rdacInput.addEventListener('input', (e) => {
Â  Â  Â  let value = e.target.value.replace(/^F12/i, '');
Â  Â  Â  if (value.length > 30) value = value.slice(0, 30);
Â  Â  Â  e.target.value = value;
Â  Â  Â  rdacCode = value;

Â  Â  Â  if (value.length === 30) {
Â  Â  Â  Â  e.target.style.display = 'none';
Â  Â  Â  Â  scanBtn.style.display = 'none';
Â  Â  Â  Â  stopScanner();
Â  Â  Â  }
Â  Â  });

Â  Â  function showQRCode() {
Â  Â  Â  if (!rdacCode) return;

Â  Â  Â  qrcodeDiv.innerHTML = '';
Â  Â  Â  qr = new QRCode(qrcodeDiv, {
Â  Â  Â  Â  text: rdacCode,
Â  Â  Â  Â  width: 150,
Â  Â  Â  Â  height: 150,
Â  Â  Â  Â  colorDark: "#000000",
Â  Â  Â  Â  colorLight: "#ffffff",
Â  Â  Â  Â  correctLevel: QRCode.CorrectLevel.H
Â  Â  Â  });

Â  Â  Â  qrcodeContainer.style.display = 'flex';
Â  Â  }

Â  Â  function hideQRCode() {
Â  Â  Â  qrcodeContainer.style.display = 'none';
Â  Â  Â  qrcodeDiv.innerHTML = '';
Â  Â  }

Â  Â  function bindHold(button, onDown, onUp) {
Â  Â  Â  button.addEventListener('touchstart', onDown);
Â  Â  Â  button.addEventListener('touchend', onUp);
Â  Â  Â  button.addEventListener('mousedown', onDown);
Â  Â  Â  button.addEventListener('mouseup', onUp);
Â  Â  }

Â  Â  bindHold(document.getElementById('left-btn'), () => leftHeld = true, () => leftHeld = false);

Â  Â  bindHold(document.getElementById('right-btn'),
Â  Â  Â  () => {
Â  Â  Â  Â  rightHeld = true;
Â  Â  Â  Â  if (leftHeld) showQRCode();
Â  Â  Â  },
Â  Â  Â  () => {
Â  Â  Â  Â  rightHeld = false;
Â  Â  Â  Â  hideQRCode();
Â  Â  Â  });

Â  Â  // Scanner logic
Â  Â  let html5Qrcode;

Â  Â  function startScanner() {
Â  Â  Â  if (scannerStarted) return;
Â  Â  Â  scannerStarted = true;
Â  Â  Â  scannerDiv.style.display = 'block';
Â  Â  Â  html5Qrcode = new Html5Qrcode("scanner");

Â  Â  Â  Html5Qrcode.getCameras().then(devices => {
Â  Â  Â  Â  if (devices && devices.length) {
Â  Â  Â  Â  Â  const cameraId = devices[0].id;
Â  Â  Â  Â  Â  html5Qrcode.start(
Â  Â  Â  Â  Â  Â  cameraId,
Â  Â  Â  Â  Â  Â  { fps: 10, qrbox: { width: 250, height: 100 } },
Â  Â  Â  Â  Â  Â  (decodedText) => {
Â  Â  Â  Â  Â  Â  Â  rdacInput.value = decodedText;
Â  Â  Â  Â  Â  Â  Â  rdacInput.dispatchEvent(new Event('input'));
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  (errorMessage) => {
Â  Â  Â  Â  Â  Â  Â  // Optional: console.log(errorMessage);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  );
Â  Â  Â  Â  }
Â  Â  Â  }).catch(err => {
Â  Â  Â  Â  alert("Unable to access camera.");
Â  Â  Â  });
Â  Â  }

Â  Â  function stopScanner() {
Â  Â  Â  if (html5Qrcode) {
Â  Â  Â  Â  html5Qrcode.stop().then(() => {
Â  Â  Â  Â  Â  scannerDiv.style.display = 'none';
Â  Â  Â  Â  Â  html5Qrcode.clear();
Â  Â  Â  Â  Â  scannerStarted = false;
Â  Â  Â  Â  }).catch(err => {
Â  Â  Â  Â  Â  console.error("Stop error:", err);
Â  Â  Â  Â  });
Â  Â  Â  }
Â  Â  }

Â  Â  scanBtn.addEventListener('click', startScanner);
Â  </script>

</body>
</html>
