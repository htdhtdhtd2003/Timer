
<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>RDAC QR Scanner</title>
Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
Â  <script src="https://unpkg.com/html5-qrcode"></script>
Â  <style>
Â  Â  * { box-sizing: border-box; }

Â  Â  body {
Â  Â  Â  margin: 0;
Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  background: #f0f0f0;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  height: 100vh;
Â  Â  }

Â  Â  #scanner {
Â  Â  Â  width: 100%;
Â  Â  Â  max-width: 400px;
Â  Â  Â  height: 40vh; /* Top 40% of viewport height */
Â  Â  Â  margin: 0 auto;
Â  Â  Â  margin-top: 10px;
Â  Â  Â  display: none;
Â  Â  Â  z-index: 999;
Â  Â  }

Â  Â  #buttons-container {
Â  Â  Â  flex-grow: 1;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: center;
Â  Â  Â  gap: 15px;
Â  Â  Â  padding: 20px;
Â  Â  Â  width: 100%;
Â  Â  }

Â  Â  button {
Â  Â  Â  width: 100%;
Â  Â  Â  height: 60px;
Â  Â  Â  font-size: 1.5rem;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  cursor: pointer;
Â  Â  }

Â  Â  #scan-btn {
Â  Â  Â  background-color: #28a745;
Â  Â  Â  color: white;
Â  Â  }

Â  Â  #toggle-camera-btn {
Â  Â  Â  background-color: #ffc107;
Â  Â  Â  color: black;
Â  Â  }

Â  Â  #rdac-input {
Â  Â  Â  width: 90%;
Â  Â  Â  font-size: 1.2rem;
Â  Â  Â  padding: 10px;
Â  Â  Â  margin: 10px auto;
Â  Â  Â  display: block;
Â  Â  }

Â  Â  /* QR code container for the generated code */
Â  Â  #qrcode-container {
Â  Â  Â  position: fixed;
Â  Â  Â  top: 10px;
Â  Â  Â  left: 50%;
Â  Â  Â  transform: translateX(-50%);
Â  Â  Â  background: white;
Â  Â  Â  padding: 10px;
Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  display: none;
Â  Â  Â  z-index: 1000;
Â  Â  }

Â  </style>
</head>
<body>

Â  <div id="qrcode-container"><div id="qrcode"></div></div>

Â  <!-- Scanner preview top center -->
Â  <div id="scanner"></div>

Â  <!-- Input field -->
Â  <input id="rdac-input" type="text" placeholder="Scan RDAC barcode..." autocomplete="off" />

Â  <!-- Buttons container at bottom half -->
Â  <div id="buttons-container">
Â  Â  <button id="scan-btn">ðŸ“· Scan Barcode</button>
Â  Â  <button id="toggle-camera-btn">ðŸ”„ Switch Camera</button>
Â  </div>

Â  <script>
Â  Â  let rdacCode = '';
Â  Â  let scannerStarted = false;
Â  Â  let html5Qrcode;
Â  Â  let currentCameraId = null;
Â  Â  let allCameras = [];
Â  Â  let isUsingFrontCamera = true;

Â  Â  const rdacInput = document.getElementById('rdac-input');
Â  Â  const qrcodeContainer = document.getElementById('qrcode-container');
Â  Â  const qrcodeDiv = document.getElementById('qrcode');
Â  Â  const scanBtn = document.getElementById('scan-btn');
Â  Â  const toggleBtn = document.getElementById('toggle-camera-btn');
Â  Â  const scannerDiv = document.getElementById('scanner');

Â  Â  rdacInput.addEventListener('input', (e) => {
Â  Â  Â  let value = e.target.value.replace(/^F12/i, '');
Â  Â  Â  if (value.length > 30) value = value.slice(0, 30);
Â  Â  Â  e.target.value = value;
Â  Â  Â  rdacCode = value;

Â  Â  Â  if (value.length === 30) {
Â  Â  Â  Â  hideAllAfterScan();
Â  Â  Â  }
Â  Â  });

Â  Â  function showQRCode() {
Â  Â  Â  if (!rdacCode) return;
Â  Â  Â  qrcodeDiv.innerHTML = '';
Â  Â  Â  new QRCode(qrcodeDiv, {
Â  Â  Â  Â  text: rdacCode,
Â  Â  Â  Â  width: 150,
Â  Â  Â  Â  height: 150,
Â  Â  Â  Â  colorDark: "#000000",
Â  Â  Â  Â  colorLight: "#ffffff",
Â  Â  Â  Â  correctLevel: QRCode.CorrectLevel.H
Â  Â  Â  });
Â  Â  Â  qrcodeContainer.style.display = 'block';
Â  Â  }

Â  Â  function hideQRCode() {
Â  Â  Â  qrcodeContainer.style.display = 'none';
Â  Â  Â  qrcodeDiv.innerHTML = '';
Â  Â  }

Â  Â  function startScanner() {
Â  Â  Â  if (scannerStarted) return;
Â  Â  Â  scannerStarted = true;
Â  Â  Â  scannerDiv.style.display = 'block';
Â  Â  Â  html5Qrcode = new Html5Qrcode("scanner");

Â  Â  Â  Html5Qrcode.getCameras().then(devices => {
Â  Â  Â  Â  allCameras = devices;
Â  Â  Â  Â  if (devices.length === 0) {
Â  Â  Â  Â  Â  alert("No camera found");
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  const preferred = isUsingFrontCamera
Â  Â  Â  Â  Â  ? devices.find(d => d.label.toLowerCase().includes("front") || d.label.toLowerCase().includes("user"))
Â  Â  Â  Â  Â  : devices.find(d => d.label.toLowerCase().includes("back") || d.label.toLowerCase().includes("environment"));

Â  Â  Â  Â  currentCameraId = preferred ? preferred.id : devices[0].id;

Â  Â  Â  Â  html5Qrcode.start(
Â  Â  Â  Â  Â  currentCameraId,
Â  Â  Â  Â  Â  { fps: 10, qrbox: { width: 250, height: 100 } },
Â  Â  Â  Â  Â  (decodedText) => {
Â  Â  Â  Â  Â  Â  rdacInput.value = decodedText;
Â  Â  Â  Â  Â  Â  rdacInput.dispatchEvent(new Event('input'));
Â  Â  Â  Â  Â  Â  hideAllAfterScan();
Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  (errorMessage) => {
Â  Â  Â  Â  Â  Â  // Optional error handling
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  );
Â  Â  Â  }).catch(err => {
Â  Â  Â  Â  alert("Camera error: " + err);
Â  Â  Â  });
Â  Â  }

Â  Â  function stopScanner() {
Â  Â  Â  if (html5Qrcode) {
Â  Â  Â  Â  html5Qrcode.stop().then(() => {
Â  Â  Â  Â  Â  scannerDiv.style.display = 'none';
Â  Â  Â  Â  Â  html5Qrcode.clear();
Â  Â  Â  Â  Â  scannerStarted = false;
Â  Â  Â  Â  }).catch(err => {
Â  Â  Â  Â  Â  console.error("Stop error:", err);
Â  Â  Â  Â  });
Â  Â  Â  }
Â  Â  }

Â  Â  function toggleCamera() {
Â  Â  Â  if (!scannerStarted || allCameras.length < 2) return;
Â  Â  Â  isUsingFrontCamera = !isUsingFrontCamera;
Â  Â  Â  stopScanner();
Â  Â  Â  setTimeout(() => startScanner(), 500);
Â  Â  }

Â  Â  function hideAllAfterScan() {
Â  Â  Â  stopScanner();
Â  Â  Â  scannerDiv.style.display = 'none';
Â  Â  Â  scanBtn.style.display = 'none';
Â  Â  Â  toggleBtn.style.display = 'none';
Â  Â  Â  rdacInput.style.display = 'none';
Â  Â  }

Â  Â  scanBtn.addEventListener('click', startScanner);
Â  Â  toggleBtn.addEventListener('click', toggleCamera);
Â  </script>
</body>
</html>
